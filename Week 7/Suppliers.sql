show databases;
create database if not exists Suppliers;
use Suppliers;
create table Supplier(Sid int, Sname varchar(30), City varchar(30), primary key(Sid));
create table Parts(Pid int, Pname varchar(30), Color varchar(30), primary key(Pid));
create table Catalog(Sid int, Pid int, Cost int, foreign key(Sid) references Supplier(Sid), foreign key(Pid) references Parts(Pid));
insert into Supplier values(10001,'Acme Widget','Banglore');
insert into Supplier values(10002,'Johns','Kolkata');
insert into Supplier values(10003,'Vimal','Mumbai');
insert into Supplier values(10004,'Reliance','Delhi');
insert into Parts values(20001,'Book','Red');
insert into Parts values(20002,'Pen','Red');
insert into Parts values(20003,'Pencil','Green');
insert into Parts values(20004,'Mobile','Green');
insert into Parts values(20005,'Charger','Black');
insert into Catalog values(10001,20001,10);
insert into Catalog values(10001,20002,10);
insert into Catalog values(10001,20003,30);
insert into Catalog values(10001,20004,10);
insert into Catalog values(10001,20005,10);
insert into Catalog values(10002,20001,10);
insert into Catalog values(10002,20002,20);
insert into Catalog values(10003,20003,30);
insert into Catalog values(10004,20003,40);
select * from Supplier;
select* from Parts;
select * from Catalog;
select distinct P.Pname from Parts P join Catalog C on P.Pid=C.Pid;
select S.Sname from Supplier S join Catalog C on C.Sid=S.Sid group by S.Sname having count(distinct C.Pid)=(select count(*) from Parts);
select S.Sname from Supplier S join Catalog C on C.Sid=S.Sid join Parts on Parts.Pid=C.Pid where Color='Red' group by S.Sid;
select P.Pname from Parts P join Catalog C on C.Pid=P.Pid join Supplier S on S.Sid=C.Sid group by P.Pname having count(distinct S.Sname)=1 and max(S.Sname)='Acme Widget';
select C.Sid from Catalog C where cost>(select avg(cost) from Catalog) group by C.Sid;
select S.Sname, P.Pname from Parts P join Catalog C1 on P.Pid=C1.Pid join Supplier S on C1.Sid=S.Sid where C1.cost=(select max(C2.Cost) from Catalog C2 where C2.Pid=P.Pid);
